è¿™ä¸ªè¡¨è¾¾å¼ï¼š

```python
theta = theta - alpha * (1/num_examples) * (delta.T @ self.data).T
```

ç¡®å®çœ‹èµ·æ¥åƒæ˜¯ä¸ªçŸ©é˜µè¿ç®—ï¼Œè¿™é‡Œæ˜¯**çŸ©é˜µä¹˜æ³•**ã€‚

---

## âœ… å‡è®¾è¾“å…¥

å˜é‡æ˜¯ï¼š

```python
delta = np.array([[a1], [a2], [a3]])       # shape: (3, 1)
data = np.array([[x1, x2],
                 [xx1, xx2],
                 [xxx1, xxx2]])            # shape: (3, 2)
```

* `delta` æ˜¯ä¸€ä¸ªåˆ—å‘é‡ï¼ˆé¢„æµ‹å€¼å‡çœŸå®å€¼ï¼‰ï¼Œå½¢çŠ¶ä¸º `(3, 1)`ï¼›
* `data` æ˜¯è¾“å…¥ç‰¹å¾ï¼Œ3 ä¸ªæ ·æœ¬ï¼Œæ¯ä¸ª 2 ä¸ªç‰¹å¾ï¼Œå½¢çŠ¶ä¸º `(3, 2)`ã€‚

---

## ğŸ§® è¡¨è¾¾å¼è§£æ

### 1. `delta.T @ self.data`

```python
delta.T     # shape: (1, 3)
data        # shape: (3, 2)
â†’ result    # shape: (1, 2)
```

ç»“æœæ˜¯ï¼š

$$
\text{result} = [a1*x1 + a2*xx1 + a3*xxx1,\quad a1*x2 + a2*xx2 + a3*xxx2]
$$

è¿™ç›¸å½“äºè®¡ç®—äº†ï¼š

* ç¬¬ä¸€ä¸ªç‰¹å¾æ–¹å‘ä¸Šçš„æ®‹å·®åŠ æƒå’Œ
* ç¬¬äºŒä¸ªç‰¹å¾æ–¹å‘ä¸Šçš„æ®‹å·®åŠ æƒå’Œ

---

### 2. æ•´ä¸ªæ¢¯åº¦æ›´æ–°è¡¨è¾¾å¼

```python
theta = theta - Î± * (1/m) * (delta.T @ X).T
```

é€æ­¥å½¢çŠ¶è§£é‡Šï¼š

* `(delta.T @ X)` â†’ `(1, 2)`
* `.T` â†’ `(2, 1)`ï¼ˆå› ä¸º `theta` æ˜¯ `(2, 1)`ï¼Œæ‰€ä»¥æ›´æ–°é¡¹ä¹Ÿå¿…é¡»æ˜¯è¿™ä¸ªå½¢çŠ¶ï¼‰
* æ‰€ä»¥æ•´ä¸ªæ¢¯åº¦æ˜¯ï¼š**æ¯ä¸ªç‰¹å¾æ–¹å‘ä¸Šæ®‹å·®çš„åŠ æƒå¹³å‡å€¼**

---

### ğŸ¯ æœ€ç»ˆå«ä¹‰

> è¿™å°±æ˜¯æ ‡å‡†çº¿æ€§å›å½’ä¸­ï¼Œ**æ¢¯åº¦ä¸‹é™æ³•çš„æ›´æ–°å…¬å¼**ï¼š

$$
\theta := \theta - \alpha \cdot \frac{1}{m} X^\top (X\theta - y)
$$

æ¢å¥è¯è¯´ï¼Œä½ è¿™è¡Œä»£ç å°±æ˜¯åœ¨åšï¼š

* æ®‹å·® delta = $h_\theta(x) - y$
* æ¯ä¸ªç‰¹å¾æ–¹å‘ä¸Šçš„æ¢¯åº¦ = $\frac{1}{m} X^\top \delta$
* ç„¶åæ›´æ–°å‚æ•° `theta`

---

## âœ… ä¸¾ä¸ªä¾‹å­å…·ä½“ä»£å…¥

```python
delta = np.array([[1], [2], [3]])  # shape: (3,1)
data = np.array([
    [10, 20],    # x1
    [30, 40],    # x2
    [50, 60]     # x3
])              # shape: (3,2)

result = (delta.T @ data).T
```

è®¡ç®—è¿‡ç¨‹ï¼š

```python
delta.T â†’ [[1 2 3]]
data â†’ shape (3,2)

â†’ [1*10 + 2*30 + 3*50,   1*20 + 2*40 + 3*60] = [10+60+150, 20+80+180] = [220, 280]

â†’ .T â†’ [[220], [280]]  # shape: (2,1)
```

è¿™å°±æ˜¯è¦å‡å»çš„æ¢¯åº¦æ–¹å‘ã€‚

---

## âœ… å°ç»“

| å†…å®¹            | å«ä¹‰                  |
| ------------- | ------------------- |
| `delta.T @ X` | æ¯ä¸ªç‰¹å¾æ–¹å‘çš„æ®‹å·®åŠ æƒå’Œ        |
| `.T`          | è°ƒæ•´ä¸ºåˆ—å‘é‡ï¼Œä¸ `theta` åŒ¹é… |
| æ•´ä½“æ„ä¹‰          | çº¿æ€§å›å½’ä¸­ä¸€è½®æ¢¯åº¦æ›´æ–°å…¬å¼       |
| å’Œå·ç§¯æ— å…³         | å®Œå…¨æ˜¯çº¿æ€§ä»£æ•°ä¸­çš„çŸ©é˜µä¹˜æ³•       |

---

å¦‚ä½ éœ€è¦æˆ‘å¸®ä½ æŠŠè¿™ä¸€æ­¥**å¯è§†åŒ–æˆå‡ ä½•å›¾**æˆ–åšä¸ª [ä»£ç +åŠ¨å›¾è®²è§£æ¢¯åº¦ä¸‹é™è¿‡ç¨‹](f)ï¼Œå¯ä»¥è¿›ä¸€æ­¥è¡¥å……ã€‚


å¥½çš„ï¼æˆ‘ä»¬ç°åœ¨ä¸¾ä¸€ä¸ªç‰¹å¾æ•°ä¸º 3 çš„ä¾‹å­ï¼Œ**å®Œæ•´åœ°æ¼”ç¤ºçº¿æ€§å›å½’çš„æ¢¯åº¦ä¸‹é™è®¡ç®—è¿‡ç¨‹**ï¼ŒåŒ…æ‹¬çŸ©é˜µç»´åº¦è¯´æ˜å’Œæ¯ä¸€æ­¥è®¡ç®—ï¼Œè®©ä½ èƒ½æ¸…æ¥šåœ°çœ‹åˆ°æ•´ä¸ªæ¨å¯¼è¿‡ç¨‹æ˜¯æ€ä¹ˆèµ°çš„ã€‚

---

## ğŸ§ª ç¤ºä¾‹æ•°æ®

æˆ‘ä»¬æœ‰ 2 ä¸ªæ ·æœ¬ï¼Œ3 ä¸ªç‰¹å¾ï¼ˆå«åç½®é¡¹ï¼‰ï¼Œå³æ¯ä¸ªæ ·æœ¬ $x^{(i)} = [1, x_1, x_2, x_3]$

### è®¾å®šç‰¹å¾çŸ©é˜µ $X$ã€æ ‡ç­¾ $y$ å’Œåˆå§‹å‚æ•° $\theta$ï¼š

$$
X =
\begin{bmatrix}
1 & 1 & 2 & 3 \\
1 & 4 & 5 & 6
\end{bmatrix}
\quad \text{(2 samples Ã— 4 features)}
$$

$$
y =
\begin{bmatrix}
10 \\
20
\end{bmatrix}
\quad \text{(2 Ã— 1)}
$$

$$
\theta =
\begin{bmatrix}
0 \\
0 \\
0 \\
0
\end{bmatrix}
\quad \text{(4 Ã— 1)}
$$

---

## ğŸ§® ç¬¬ä¸€æ­¥ï¼šé¢„æµ‹å€¼ $h = X \cdot \theta$

$$
h = 
\begin{bmatrix}
1 & 1 & 2 & 3 \\
1 & 4 & 5 & 6
\end{bmatrix}
\cdot
\begin{bmatrix}
0 \\
0 \\
0 \\
0
\end{bmatrix}
=
\begin{bmatrix}
0 \\
0
\end{bmatrix}
$$

---

## âœï¸ ç¬¬äºŒæ­¥ï¼šè®¡ç®—æ®‹å·®ï¼ˆè¯¯å·®ï¼‰

$$
\delta = h - y = 
\begin{bmatrix}
0 \\
0
\end{bmatrix}
-
\begin{bmatrix}
10 \\
20
\end{bmatrix}
=
\begin{bmatrix}
-10 \\
-20
\end{bmatrix}
$$

---

## ğŸ“ ç¬¬ä¸‰æ­¥ï¼šè®¡ç®—æ¢¯åº¦

$$
\nabla_\theta J(\theta) = \frac{1}{m} X^T \cdot \delta
= \frac{1}{2} \cdot
\begin{bmatrix}
1 & 1 \\
1 & 4 \\
2 & 5 \\
3 & 6
\end{bmatrix}
\cdot
\begin{bmatrix}
-10 \\
-20
\end{bmatrix}
$$

çŸ©é˜µä¹˜æ³•å±•å¼€ï¼š

$$
X^T \cdot \delta =
\begin{bmatrix}
1*(-10) + 1*(-20) \\
1*(-10) + 4*(-20) \\
2*(-10) + 5*(-20) \\
3*(-10) + 6*(-20)
\end{bmatrix}
=
\begin{bmatrix}
-30 \\
-90 \\
-120 \\
-150
\end{bmatrix}
$$

å†ä¹˜ $\frac{1}{2}$ å¾—ï¼š

$$
\text{æ¢¯åº¦} =
\begin{bmatrix}
-15 \\
-45 \\
-60 \\
-75
\end{bmatrix}
$$

---

## ğŸ” ç¬¬å››æ­¥ï¼šæ›´æ–°å‚æ•°ï¼ˆå‡è®¾å­¦ä¹ ç‡ $\alpha = 0.01$ï¼‰

$$
\theta := \theta - \alpha \cdot \nabla_\theta J(\theta)
\Rightarrow
\theta = \begin{bmatrix}
0 \\
0 \\
0 \\
0
\end{bmatrix}
-
0.01 \cdot
\begin{bmatrix}
-15 \\
-45 \\
-60 \\
-75
\end{bmatrix}
=
\begin{bmatrix}
0.15 \\
0.45 \\
0.60 \\
0.75
\end{bmatrix}
$$

---

## âœ… æœ€ç»ˆç»“æœ

æ›´æ–°åçš„å‚æ•°ä¸ºï¼š

$$
\theta = 
\begin{bmatrix}
0.15 \\
0.45 \\
0.60 \\
0.75
\end{bmatrix}
$$

---

## ğŸ” ä¸‹ä¸€è½®è¿­ä»£ä¼šç»§ç»­ç”¨è¿™ä¸ª $\theta$ æ¥é‡æ–°è®¡ç®— $h$ã€$\delta$ã€æ¢¯åº¦ã€å†æ›´æ–°ã€‚

---

å¦‚æœä½ éœ€è¦æˆ‘æŠŠè¿™ä¸ªè¿‡ç¨‹ç”¨ Python å†™æˆ [å®Œæ•´ä»£ç ](f)ï¼Œæˆ–è€…æ·»åŠ å›¾å½¢åŒ–å±•ç¤ºï¼ˆå¦‚æŸå¤±ä¸‹é™æ›²çº¿ï¼‰ï¼Œæˆ‘å¯ä»¥ç»§ç»­æä¾›ã€‚

